fragment OrganizationTokenDetails on Token {
    ...TokenDetails
    ... on OrganizationPermissionsToken {
        permissions
    }
}

query GetOrganizationToken(
    $Id: String!
) {
    tokens(
        searchFilter: $Id
        sortBy: Name
        typeFilter: OrganizationPermissionToken
    ) {
        results {
            ...OrganizationTokenDetails
        }
    }
}

mutation CreateOrganizationToken(
    $Name: String!
    $IPFilterId: String
    $ExpiresAt: Long
    $Permissions: [OrganizationPermission!]!
) {
    createOrganizationPermissionsToken(
        input: {
            name: $Name
            expireAt: $ExpiresAt
            ipFilterId: $IPFilterId
            permissions: $Permissions
        }
    )
}

mutation UpdateOrganizationToken(
    $Id: String!
    $Permissions: [OrganizationPermission!]!
) {
    updateOrganizationPermissionsTokenPermissions
    (
        input: {
            id: $Id
            permissions: $Permissions
        }
    )
}