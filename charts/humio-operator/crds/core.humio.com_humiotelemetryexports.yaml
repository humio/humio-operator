---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.0
  name: humiotelemetryexports.core.humio.com
  labels:
    app: 'humio-operator'
    app.kubernetes.io/name: 'humio-operator'
    app.kubernetes.io/instance: 'humio-operator'
    app.kubernetes.io/managed-by: 'Helm'
    helm.sh/chart: 'humio-operator-0.0.1'
spec:
  group: core.humio.com
  names:
    kind: HumioTelemetryExport
    listKind: HumioTelemetryExportList
    plural: humiotelemetryexports
    singular: humiotelemetryexport
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Export state
      jsonPath: .status.state
      name: State
      type: string
    - description: Number of registered collections
      jsonPath: .spec.registeredCollections[*]
      name: Collections
      type: integer
    - description: Last export time
      jsonPath: .status.lastExportTime
      name: Last Export
      type: date
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: HumioTelemetryExport is the Schema for the humiotelemetryexports
          API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: HumioTelemetryExportSpec defines the desired state of HumioTelemetryExport.
            properties:
              registeredCollections:
                description: RegisteredCollections lists the HumioTelemetryCollection
                  resources to accept data from
                items:
                  description: HumioTelemetryCollectionReference references a HumioTelemetryCollection
                    resource
                  properties:
                    name:
                      description: Name of the HumioTelemetryCollection resource
                      minLength: 1
                      type: string
                    namespace:
                      description: |-
                        Namespace of the HumioTelemetryCollection resource
                        If empty, defaults to the same namespace as this export resource
                      type: string
                  required:
                  - name
                  type: object
                minItems: 1
                type: array
              remoteReport:
                description: RemoteReport defines the configuration for sending telemetry
                  data to a remote cluster
                properties:
                  tls:
                    description: TLS contains TLS configuration for the connection
                    properties:
                      insecureSkipVerify:
                        default: false
                        description: InsecureSkipVerify controls whether the client
                          verifies the server's certificate chain and hostname
                        type: boolean
                    type: object
                  token:
                    description: Token contains the authentication token for the telemetry
                      cluster
                    properties:
                      secretKeyRef:
                        description: SecretKeyRef allows specifying which secret and
                          what key in that secret holds the value we want to use
                        properties:
                          key:
                            description: The key of the secret to select from.  Must
                              be a valid secret key.
                            type: string
                          name:
                            default: ""
                            description: |-
                              Name of the referent.
                              This field is effectively required, but due to backwards compatibility is
                              allowed to be empty. Instances of this type with an empty value here are
                              almost certainly wrong.
                              More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                            type: string
                          optional:
                            description: Specify whether the Secret or its key must
                              be defined
                            type: boolean
                        required:
                        - key
                        type: object
                        x-kubernetes-map-type: atomic
                    type: object
                  url:
                    description: URL is the endpoint URL for the telemetry cluster
                      HEC endpoint
                    pattern: ^https?://
                    type: string
                required:
                - token
                - url
                type: object
              sendCollectionErrors:
                default: true
                description: |-
                  SendCollectionErrors controls whether collection errors are exported to the telemetry cluster
                  When enabled (default), collection errors are sent as telemetry payloads for analysis
                  When disabled, collection errors are only logged locally and recorded as Kubernetes events
                type: boolean
            required:
            - registeredCollections
            - remoteReport
            type: object
          status:
            description: HumioTelemetryExportStatus defines the observed state of
              HumioTelemetryExport.
            properties:
              exportErrors:
                description: ExportErrors contains any errors from data export
                items:
                  description: HumioTelemetryExportError represents an error that
                    occurred during telemetry export operations
                  properties:
                    dataType:
                      description: DataType indicates which data type this error relates
                        to (if applicable)
                      type: string
                    message:
                      description: Message is the human-readable error message
                      type: string
                    timestamp:
                      description: Timestamp indicates when this error occurred
                      format: date-time
                      type: string
                    type:
                      description: Type is the category of error (e.g., "export",
                        "configuration")
                      type: string
                  required:
                  - message
                  - timestamp
                  - type
                  type: object
                type: array
              lastExportTime:
                description: LastExportTime indicates when data was last exported
                  successfully
                format: date-time
                type: string
              registeredCollectionStatus:
                additionalProperties:
                  description: HumioTelemetryCollectionRegistrationStatus tracks the
                    registration status with a specific collection
                  properties:
                    found:
                      description: Found indicates whether the referenced collection
                        resource exists
                      type: boolean
                    lastDataReceived:
                      description: LastDataReceived indicates when data was last received
                        from this collection
                      format: date-time
                      type: string
                    lastExportError:
                      description: LastExportError contains the most recent export
                        error for this collection
                      properties:
                        dataType:
                          description: DataType indicates which data type this error
                            relates to (if applicable)
                          type: string
                        message:
                          description: Message is the human-readable error message
                          type: string
                        timestamp:
                          description: Timestamp indicates when this error occurred
                          format: date-time
                          type: string
                        type:
                          description: Type is the category of error (e.g., "export",
                            "configuration")
                          type: string
                      required:
                      - message
                      - timestamp
                      - type
                      type: object
                    successfulExports:
                      description: SuccessfulExports is the number of successful exports
                        for data from this collection
                      type: integer
                    totalExports:
                      description: TotalExports is the total number of export attempts
                        for data from this collection
                      type: integer
                  required:
                  - found
                  type: object
                description: RegisteredCollectionStatus tracks the status of registration
                  with collections
                type: object
              state:
                description: State represents the current state of the export
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
